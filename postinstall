#!/bin/bash

if [[ -f `pwd`/sharedfuncs ]]; then
  source sharedfuncs
else
  echo "missing file: sharedfuncs"
  exit 1
fi

check_root

print_line

check_connection


print_line






print_info "Set sudo username"
USERentered=0
user_exists=1

while [ $user_exists -eq 1 ];
do
    
    while [ $USERentered -eq 0 ];
    do
		read -p "Please enter a username for the system: " username
		print_info "This user needs to be a sudo user!"
		yn_question "Do you realy want to use ${username}?"
		if [ $ynAnswer == "y" ]; then
			USERentered=1
		fi
    done


    user_exists=$(id -u "$username" > /dev/null 2>&1; echo $?)

    if [ $user_exists -eq 1 ]; then
		yn_question "This user does not exists, please try again!"
    fi

done
print_info "The username is now $username"










cecho "CLEAN ORPHAN PACKAGES - https://wiki.archlinux.org/index.php/Pacman/Tips_and_tricks#Removing_unused_packages_.28orphans.29" 

# cleanup
pacman -Rcns --noconfirm $(pacman -Qtdq)
# this will delete the complete package cache and is not recommended to do usually
paccache -r -k 0
pacman -Scc --noconfirm



print_line
print_line
cecho "\n\n" 

cecho "Finish :)" 
cecho "Please reboot and enjoy" 
